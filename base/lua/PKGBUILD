#!/bin/bash

pkgname=lua
pkgver=5.4.2
archive=$pkgname-$pkgver.tar.gz
sum=96d4a21393c94bed286b8dc0568f4bdde8730b22

dstdir=$mkToolchainBase

build() {
  download https://www.lua.org/ftp/$archive
  check $archive $sum
  extract $archive

  pushd $pkgname-$pkgver
    message "Compiling $pkgname"
    sed -i "s:INSTALL_TOP=.*:INSTALL_TOP=$dstdir:g" Makefile
    sed -i "s:/man/man1:/share/man/man1:g" Makefile
    sed -i "s:MYLIBS=:MYLIBS=$(pkg-config --libs ncurses):g" src/Makefile
    make linux
  popd
}

package() {
  make -C $pkgname-$pkgver install
}
